%% Практична робота №7. Варіант 8
% Тема: Реалізація знаходження наближених значень визначених інтегралів
% Виконавець: Варіант №8
% f(x) = sqrt(1 - 0.2*sin(x)^2), a=0, b=1, N=10

clc; clear; close all;

%% Вхідні дані
f = @(x) sqrt(1 - 0.2*sin(x).^2);
a = 0;
b = 1;
N = 10;
h = (b - a) / N;
x = a:h:b;
y = f(x);

fprintf('Практична робота №7 (варіант 8)\n');
fprintf('f(x) = sqrt(1 - 0.2*sin^2(x)), a = %.1f, b = %.1f, N = %d\n\n', a, b, N);

%% --- Метод лівих прямокутників ---
Fl = h * sum(y(1:end-1));
fprintf('Метод лівих прямокутників: %.6f\n', Fl);

%% --- Метод правих прямокутників ---
Fr = h * sum(y(2:end));
fprintf('Метод правих прямокутників: %.6f\n', Fr);

%% --- Метод середніх прямокутників ---
x_mid = a + h/2 : h : b - h/2;
y_mid = f(x_mid);
Fm = h * sum(y_mid);
fprintf('Метод середніх прямокутників: %.6f\n', Fm);

%% --- Метод трапецій ---
Ft = h * (0.5*y(1) + sum(y(2:end-1)) + 0.5*y(end));
fprintf('Метод трапецій: %.6f\n', Ft);

%% --- Метод Сімпсона ---
% Переконаємося, що N парне (вимога для формули Сімпсона)
if mod(N,2) ~= 0
    warning('Для методу Сімпсона N повинно бути парним. Використовується N+1.');
    N = N + 1;
    h = (b - a)/N;
    x = a:h:b;
    y = f(x);
end

Fs = (h/3) * (y(1) + 4*sum(y(2:2:end-1)) + 2*sum(y(3:2:end-2)) + y(end));
fprintf('Метод Сімпсона: %.6f\n', Fs);

%% --- Порівняння результатів ---
fprintf('\nПорівняння методів:\n');
fprintf('Ліві прямокутники: %.6f\n', Fl);
fprintf('Праві прямокутники: %.6f\n', Fr);
fprintf('Середні прямокутники: %.6f\n', Fm);
fprintf('Трапеції: %.6f\n', Ft);
fprintf('Сімпсона: %.6f\n', Fs);

%% --- Візуалізація ---
xx = linspace(a,b,200);
plot(xx, f(xx),'LineWidth',1.5); hold on; grid on;
title('Графік підінтегральної функції f(x)');
xlabel('x'); ylabel('f(x)');
