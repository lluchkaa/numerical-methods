%% Практична робота №8. Варіант 8
% Тема: Наближене розв'язування звичайних диференціальних рівнянь
% Виконавець: Варіант №8
% m = 4, n = 7

clc; clear; close all;
m = 4; n = 7;

%% ----------------------------------------------------------
% ЗАДАЧА 1. Диференціальне рівняння (методи Ейлера та Рунге–Кутта)
% y' = (x - n)*exp(-m*(x + y)) + 2*n*sin(x) - y^2 + 2,
% y(0) = (m + n)/(2*m + 1)

f = @(x,y) (x - n).*exp(-m*(x + y)) + 2*n*sin(x) - y.^2 + 2;
a = 0; b = 1; h = 0.1;
x = a:h:b;
y0 = (m + n)/(2*m + 1);
y = zeros(size(x));
y(1) = y0;

% --- Метод Ейлера ---
for i = 1:length(x)-1
    y(i+1) = y(i) + h * f(x(i), y(i));
end

fprintf('Метод Ейлера: y(1) = %.6f\n', y(end));

% --- Метод Рунге–Кутта 4-го порядку ---
yRK = zeros(size(x));
yRK(1) = y0;
for i = 1:length(x)-1
    k1 = f(x(i), yRK(i));
    k2 = f(x(i) + h/2, yRK(i) + h*k1/2);
    k3 = f(x(i) + h/2, yRK(i) + h*k2/2);
    k4 = f(x(i) + h, yRK(i) + h*k3);
    yRK(i+1) = yRK(i) + (h/6)*(k1 + 2*k2 + 2*k3 + k4);
end

fprintf('Метод Рунге–Кутта: y(1) = %.6f\n', yRK(end));

% --- Побудова графіків ---
figure;
plot(x, y, 'r.-', x, yRK, 'b.-', 'LineWidth', 1.5);
legend('Метод Ейлера', 'Метод Рунге–Кутта');
title('Розвязок задачі Коші (варіант 8)');
xlabel('x'); ylabel('y');
grid on;

%% ----------------------------------------------------------
% ЗАДАЧА 2. Система диференціальних рівнянь (метод Ейлера)
% {
%   x'(t) = n*t*exp(-n*t)*(y + x) - (m + n)*x,
%   y'(t) = (2*n + 1)*x*y^2 - ((n + 1)*t)/(2*m + 1),
%   x(0) = (n + 1)/(2*m + 1), y(0) = (2*m)/(n + 2)
% }

f1 = @(t,x,y) n*t.*exp(-n*t).*(y + x) - (m + n)*x;
f2 = @(t,x,y) (2*n + 1)*x.*y.^2 - ((n + 1)*t)/(2*m + 1);
a = 0; b = 1; h = 0.1;
t = a:h:b;
xv = zeros(size(t)); yv = zeros(size(t));
xv(1) = (n + 1)/(2*m + 1);
yv(1) = (2*m)/(n + 2);

for i = 1:length(t)-1
    xv(i+1) = xv(i) + h * f1(t(i), xv(i), yv(i));
    yv(i+1) = yv(i) + h * f2(t(i), xv(i), yv(i));
end

fprintf('\nСистема рівнянь (Метод Ейлера):\n');
fprintf('x(1) = %.6f, y(1) = %.6f\n', xv(end), yv(end));

figure;
plot(t, xv, 'b.-', t, yv, 'r.-', 'LineWidth', 1.5);
legend('x(t)', 'y(t)');
title('Розвязок системи диференціальних рівнянь (варіант 8)');
xlabel('t'); ylabel('Значення функцій');
grid on;
